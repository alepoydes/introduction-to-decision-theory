# Лабораторная работа №1: "Парадоксы теории вероятностей"

Целью работы является повторение основ теории вероятностей
и прояснение нетривиальных моментов теории вероятностей,
формулируемых в виде парадоксов.

Работа состоит из двух частей, обе части необходимо выполнить.
Каждая часть содержит в себе теоретические вопросы и 
практическое задание на статистическую проверку гипотезы.
Результатом выполнения теоретической части является
письменный ответ на вопросы лабораторной работы 
со строгим математическим обоснованием.
Результатом выполнения практической части является
программа, симулирующая описанную в лабораторной проблему,
а также заключении о верности предсказанных в теоретической части
исходов, на основе результатов симуляции. 
Для полного выполнения работы необходимо ответить на все вопросы
из задания.
Работа считается выполненной на ц3минимальное число баллов,
если дан ответ на 2/3 вопросов.

## Часть 1. "[Парадокс Монти Холла](ru.wikipedia.org/wiki/Парадокс_Монти_Холла)"

В [развлекательной передаче Монти Холла](en.wikipedia.org/wiki/Let%27s_Make_a_Deal)
игроку предлагали следующую ситуацию.
Перед вами находятся три двери,
за каждой дверью спрятана либо коза, либо машина.
Известно, что машина одна, а коз две.
У игрока первоначально нет никакой информации где что находится.
Игроку предлагается выбрать одну дверь,
в конце передачи ведущий откроет выбранную дверь, 
и игрок получит то, что находится за дверью в качестве приза.
Так как в условиях задачи все двери эквивалентны,
то вероятность угадать машину равна 1/3, независимо от выбора двери.
Затем ведущий открывает одну из оставшихся дверей,
за открытой дверью находится коза.
Ведущий предлагает игроку выбор: 
хочет ли он поменять свой выбор, учитывая новую информацию?
Интуитивно люди склонны предполагать, что выбор двери не важен,
так как осталось два варианта выбора двери, за которыми спрятана
одна машина, так что вероятность нахождения машины за обоими дверьми 
равна 50%.
Однако этот ответ ошибочный.

Вопросы и задания.

1. Какова вероятность найти машину за первоначально выбранной дверью
после демонстрации ведущим козы? 
Какова вероятность выиграть машину изменив выбор?

1. Можно ли утверждать, что вероятность обнаружить машину за первоначально
выбранной игроком дверью не меняется при поступлении информации,
что за одной из оставшихся дверей находится коза, 
так как выбор двери игроком был осуществлен раньше, чем игроку показали козу?
Изменится ли вероятность открыть машину, если за открытой ведущей дверью 
окажется машина?

1. Будет ли результат одинаков при следующих условиях: 
а) ведущий знает, что за дверью находится коза, и целенаправленно открывает дверь с козой;
б) ведущий выбирает оставшиеся после выбора игрока двери равновероятно, 
и коза оказывается за дверью случайно?

1. Посчитайте вероятности выигрыша машины при сохранении и смене своего выбора 
для следующей вариации игры.
Всего имеется D дверей, за которыми спрятаны C машин и D-C коз.
Игрок выбирает дверь, затем ведущий открывает одну из дверей, за которой спрятана коза,
причем он никогда не открывает дверь, которую выбрал игрок.
Наконец игроку предлагается сохранить свой выбор или выбрать любую из закрытых дверей.

1. Как изменится ответ, если ведущий откроет N дверей, за G из которых окажутся козы,
а за N-G будут машины?
В каком случае игроку выгодно поменять выбор?

1. При изучении парадоксов люди склонны ошибаться.
Считая полученные выше предсказания для вероятностей выигрыша со сменой и без
смены выбора гипотезами, проверить эти гипотезы статистически.
Моделью игры будет некое размещение коз и машин в указанном количестве за дверьми
(т.е. просто вектор значений коза/машина).
Без ограничения общности можно считать, что игрок первоначально всегда выбирает первую дверь,
а меняет выбор на вторую дверь.
Выполните численное моделирование, сгенерировав выборку из M реализаций игры,
и посчитайте долю выигрышей при сохранении выбора двери и при смене выбора. 

1. Как сгенерировать размещение машин за дверьми так, чтобы все размещения были равновероятны?

1. Насколько точную оценку вероятности выигрыша дает найденная по выборке доля выигрышей?
Как зависит точность от размера выборки?

1. Можем ли мы принять нашу гипотезу о вероятности выигрыша,
или должны отвергнуть ее?

1. В описанной выше процедуре моделирования каждое размещение машин за дверьми
использовалось только один раз при подсчете выигрышей при изменении выбора двери.
Не является ли это пустым расходом ресурсов?
Мы можем считать, что выбор меняется не только на вторую дверь, но также на третью,
четвертую и т.д., т.е. считая размещение фиксированным, мы для каждой из дверей
увеличим счетчик выигрышей, если за дверью находится машина, и увеличим счетчик
проигрышей, если за машиной находится коза, тем самым увеличив в D-2 раза размер выборки.
Дадут ли оба метода моделирования один результат?

## Часть 2. [Парадокс двух конвертов](ru.wikipedia.org/wiki/Задача_о_двух_конвертах).

Ведущий предлагает вам и вашему противнику сыграть в следующую игру.
Ведущий располагает некоторой случайной суммой денег S,
которую он делит на две части и раскладывает эти деньги в два конверта,
причем в одном конверте денег в два раза больше, чем в другом.
Затем ведущий случайным образом раздает конверты вам и вашему противнику,
не делая предпочтений и никак вас не различая.
Затем вы открываете ваш конверт и видите сумму денег X, 
находящихся в вашем конверте.
Теперь ведущий спрашивает вас, хотите ли вы поменяться конвертами с противником?
В конверте противника находится либо сумма 2X, либо X/2, 
причем естественном предположить, что оба варианта реализуются с вероятностью 50%,
так как при раздаче конвертов предпочтений не было.
Тогда математическое ожидание суммы Y в конверте противника равно

$$
E[Y]=0.5*2X+0.5*X/2=5X/4>X.
$$

Таким образом в конверте у противника в среднем денег больше, чем у вас,
и при обмене ожидается выигрыш $X/4$.
Однако аналогичные рассуждения применимы и к противнику,
и ему тоже выгодно поменять конверты, что парадоксально, 
так как если один игрок выигрывает при обмене конвертами, то второй проигрывает.

Вопросы и задания.

1. В парадоксе неявно предполагается, что сумма денег в конверте не ограничена
и все суммы равновероятны. Возможно ли это?

1. Если известно, что бюджет ведущего ограничен сверху и снизу некоторыми суммами,
стоит ли вам меняться конвертами, если вы получили минимально возможную
или максимально возможную сумму в конверте?

1. Считая, что суммарное количество денег S в конвертах есть случайная величина,
имеющая плотность распределения $f_S$, найти вероятность того,
что у противника больше денег в конверте, если в вашем конверте оказалась сумма X=x.

1. Можно ли теперь утверждать, что если одному из игроков обмен выгоден,
то второму обмен не выгоден, тем самым парадокс разрешается?

1. Найдите математическое ожидание суммы денег в конверте противника,
если в вашем конверте оказалась сумма X=x.
Найдите ваш выигрыш при обмене конвертами, как функцию x.

1. Как изменится ответ, если ведущий подыгрывает вашему противнику,
отдавая ему конверт с большей суммой с вероятностью p?
Стоит ли производить обмен, если p=1? А если p=0? 
Как это согласуется с общей формулой?

1. Проведите численное моделирование игры:
сгенерируйте выборку значений суммы в двух конвертах,
разложите случайным образом суммы по конвертам.
Отметьте реализации игры, в которых вам достался конверт с наибольшей суммой,
для всех реализаций  посчитайте величину выигрыша при обмене конвертами.
Сгруппировав игры по близким значениям сумм в конверте первого игрока,
посчитайте долю реализаций с большей суммой в конверте первого игрока
и средний выигрыш первого игрока при обмене конвертами внутри каждой группы.
Постройте графики оценки условной вероятности получить конверт с максимальной
суммой и условного математического ожидания выигрыша при обмене конвертами,
как функции от числа денег в конверте игрока X.

